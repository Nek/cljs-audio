{"version":3,"sources":["editscript/core.cljc"],"mappings":";AAkBA,AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uBAAA,+BAAAA,tDAAME;AAAN,AAAA,IAAAD,WAAA,AAAA;AAAA,AAAA,QAAAA;KAAA;AAAA,OAAAC,mDAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;KAAA;AAAA,OAAAA,mDAAA,CAAA,UAAA,MAAA,CAAA,UAAA,MAAA,CAAA,UAAA;;;;AAAA,MAAA,KAAAC,MAAA,CAAA,8DAAA,AAAA;;;;;AAAA,CAAA,qDAAA,rDAAMD,gEA4BFM,EAAEC;AA5BN,AA6BG,8DAAA,2CAAA,qDAAA,yDAAA,8DAAA,9QAACC,mDAAKF,EAAEC;;;AA7BX,CAAA,qDAAA,eAAAL,pEAAMF,gEA8BFM,EAAEC;AA9BN,AAAA,IAAAJ,aAAAD;IAAAC,iBAAA,AAAAC,4BAAAD;WAAA,AAAAE,4CAAAF,eAAA,qDAAA,vHA8BgBM;sBA9BhB,AAAAJ,4CAAAF,eAAA,8DAAA,3IA8BqBO;AA9BrB,AA+BG,0EAAA,2CAAA,0DAAA,xKAACC,+DAAYL,EAAEC,kGAASE,mEAAgBC;;;AA/B3C,CAAA,+CAAA,/CAAMV;;AAAN,AAiCA;;;;;wBAAA,xBAAMY,wDAIHN,EAAEO;AAJL,AAAA,GAKS,mBAAWC,lBAA2BD;AAL/C;AAAA,AAAA,MAAA,KAAAZ,MAAA;;;AAME,sDAAA,WAAAc,iBAAAC,3EAACC;AAAD,AACG,oCAAAF,iBAAAC,9CAACE;GACFZ,EACA,AAACa,0BAAYN;;AAEjB;;;;AAGEO,qCAAaC;AAEf;;;;AAGEC,0BAAQC;AAEV;;;AAEEC,2BAASC;AAEX;;;;AAGEC,gCAAcC;AAEhB;;;AAEEC,4BAAUT;AAEZ;;;AAEEU,+BAAaC;AAEf;;;AAEEC,+BAAaC;AAEf;;;AAEEC,+BAAaC;AAEf;;;;AAGEC,mCAAcC","names":["var_args","G__53300","editscript.core/diff","js/Error","p__53303","map__53305","cljs.core/--destructure-map","cljs.core.get","a","b","editscript.core.diff","algo","str-diff?","editscript.util.common/diff-algo","editscript.core/patch","script","editscript.edit/EditScript","p1__53307#","p2__53308#","cljs.core.reduce","editscript.patch/patch*","editscript.edit/get-edits","editscript.core/valid-edits?","editscript.edit/valid-edits?","editscript.core/combine","editscript.edit/combine","editscript.core/get-size","editscript.edit/get-size","editscript.core/edit-distance","editscript.edit/edit-distance","editscript.core/get-edits","editscript.core/get-adds-num","editscript.edit/get-adds-num","editscript.core/get-dels-num","editscript.edit/get-dels-num","editscript.core/get-reps-num","editscript.edit/get-reps-num","editscript.core/edits->script","editscript.edit/edits->script"],"sourcesContent":[";;\n;; Copyright (c) Huahai Yang. All rights reserved.\n;; The use and distribution terms for this software are covered by the\n;; Eclipse Public License 1.0 (http://opensource.org/licenses/eclipse-1.0.php)\n;; which can be found in the file LICENSE at the root of this distribution.\n;; By using this software in any fashion, you are agreeing to be bound by\n;; the terms of this license.\n;; You must not remove this notice, or any other, from this software.\n;;\n\n(ns editscript.core\n  (:require [editscript.edit :as e]\n            [editscript.patch :as p]\n            [editscript.util.common :as c]\n            [editscript.diff.quick]\n            [editscript.diff.a-star])\n  #?(:clj (:import [editscript.edit EditScript])))\n\n(defn diff\n  \"Create an editscript to represent the transformations needed to turn a\n  Clojure data structure `a` into another Clojure data structure `b`.\n\n  This function accepts any nested Clojure data structures. In Clojure, those\n  implement `IPersistentVector`, `IPersistentMap`, `IPersistentList`,\n  and `IPersistentSet` will be treated as collections. The same are true for\n  the corresponding deftypes in Clojurescript, such as `PersistentVector`,\n  `PersistentMap`, and so on. Anything else are treated as atomic values.\n\n  The editscript is represented as a vector of basic operations: add `:+`,\n  delete `:-`, and replace `:r`. Each operation also include a path to the\n  location of the operation, which is similar to the path vector in `update-in`.\n  However, editscript path works for all above four collection types, not just\n  associative ones. For `:+` and `:r`, a new value is also required.\n\n\n  The following options are supported in the option map:\n\n  * `:algo`  chooses the diff algorithm. The value can be `:a-star` (default) or\n  `:quick`; `:a-star` algorithm minimize the size of the resulting editscript,\n  `:quick` algorithm is much faster, but does not producing diff with minimal size.\n\n  * `:str-diff?` indicates a desire to perform string diff. It  may reduce the\n  result size for small changes in long strings, but will incur a slight computation\n  cost. The value is a boolean: `true` or `false` (default). When enabled, the diff\n  algorithm will perform string diff if the changes are less than 30 percent of the\n  string length; otherwise, whole string replacement will be used.\"\n  ([a b]\n   (diff a b {:algo :a-star :str-diff? false}))\n  ([a b {:keys [algo str-diff?] :or {algo :a-star str-diff? false}}]\n   (c/diff-algo a b {:algo algo :str-diff? str-diff?})))\n\n(defn patch\n  \"Apply the editscript `script` on `a` to produce `b`, assuming the\n  script is the results of running  `(diff a b)`, such that\n  `(= b (patch a (diff a b)))` is true\"\n  [a script]\n  {:pre [(instance? editscript.edit.EditScript script)]}\n  (reduce\n    #(p/patch* %1 %2)\n    a\n    (e/get-edits script)))\n\n(def ^{:arglists '([edits])\n       :doc      \"Check if the given vector represents valid edits that can be turned\ninto an EditScript\"}\n  valid-edits? e/valid-edits?)\n\n(def ^{:arglists '([this that])\n       :doc      \"Concate that editscript onto this editscript, return the new\neditscript\"}\n  combine e/combine)\n\n(def ^{:arglists '([es])\n       :doc      \"Report the size of the editscript\"}\n  get-size e/get-size)\n\n(def ^{:arglists '([es])\n       :doc      \"Report the edit distance of the editscript, i.e. number of\noperations\"}\n  edit-distance e/edit-distance)\n\n(def ^{:arglists '([es])\n       :doc      \"Report the edits of the editscript as a vector\"}\n  get-edits e/get-edits)\n\n(def ^{:arglists '([es])\n       :doc      \"Report the number of additions in the editscript\"}\n  get-adds-num e/get-adds-num)\n\n(def ^{:arglists '([es])\n       :doc      \"Report the number of deletes in the editscript\"}\n  get-dels-num e/get-dels-num)\n\n(def ^{:arglists '([es])\n       :doc      \"Report the edits of replacements in the editscript\"}\n  get-reps-num e/get-reps-num)\n\n(def ^{:arglists '([edits])\n       :doc      \"Create an EditScript instance from a vector of edits, like those\nobtained through calling `get-edits` on an EditScript\"}\n  edits->script e/edits->script)\n"]}